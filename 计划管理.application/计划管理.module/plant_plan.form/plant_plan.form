<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<form id="__11e9-7a26-62f463d1-9820-539e9af1e136">
  <name>plant_plan</name>
  <parentId>11e9-7a26-62f43cbe-9820-539e9af1e136</parentId>
  <description>厂级计划表</description>
  <templatecontext><![CDATA[<p abp="29911">
<table class="form_table" abp="29912" width="100%" cellspacing="1" cellpadding="1" border="0" align="center">
    <caption abp="29913">厂级计划表Plant-Level Plan</caption>
    <tbody abp="29914">
        <tr abp="29915">
            <td class="td_label" abp="29916" width="120">计划编号&nbsp;Plan Number</td>
            <td abp="29917"><input id="11e3-0efa-e4ed81b6-a0a4-df64d61cdd0b" class="cn.myapps.runtime.dynaform.form.ejb.InputField" value="" name="_pNo" abp="29918" filtercondition="" discript="计划编号" mobile="true" fieldkeyevent="Tabkey" valuescript="var@nbsp;_pSaveAndNew@nbsp;=@nbsp;getSession(@quot;_pSaveAndNew@quot;);&#9;//获取session值@amp;#13;var@nbsp;_pSaveAndNewDocid@nbsp;=@nbsp;getSession(@quot;_pSaveAndNewDocid@quot;);&#9;//获取session值@amp;#13;var@nbsp;curDoc@nbsp;=@nbsp;getCurrentDocument();@amp;#13;var@nbsp;docid@nbsp;=@nbsp;curDoc.getId();@amp;#13;@amp;#13;var@nbsp;_pNo@nbsp;=@nbsp;getItemValueAsString(@quot;_pNo@quot;);@amp;#13;if((docid!=null@nbsp;@amp;@amp;@nbsp;!docid==(@quot;@quot;)@nbsp;@amp;@amp;@nbsp;_pSaveAndNew!=null@nbsp;@amp;@amp;@nbsp;_pSaveAndNewDocid!=null@amp;#13;@nbsp;@nbsp;@nbsp;@nbsp;@amp;@amp;@nbsp;_pSaveAndNew==(_pNo)@nbsp;@amp;@amp;@nbsp;!_pSaveAndNewDocid==(docid))@nbsp;||@nbsp;(_pNo!=null@nbsp;@amp;@amp;@nbsp;_pNo==(@quot;@quot;))){@amp;#13;@nbsp;@nbsp;@nbsp;@nbsp;countNext2(@#146;JH@#146;,true,true,true,3);@amp;#13;}" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="readonly" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" numberpattern="" bordertype="false" fieldtype="VALUE_TYPE_VARCHAR" text="readonly" classname="cn.myapps.runtime.dynaform.form.ejb.InputField" readonlyshowvalonly="true" isdefaultvalue="false" refreshmode="0" refreshfields="" /></td>
            <td class="td_label" abp="29919" width="120">计划类型Plan Type</td>
            <td abp="29920"><select id="11e3-44f9-a2be1ac8-bf16-33864f4d4b3c" class="cn.myapps.runtime.dynaform.form.ejb.SelectField" abp="29921" filtercondition="" discript="计划类型" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="true" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草部门主任审核@quot;)@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_VARCHAR" classname="cn.myapps.runtime.dynaform.form.ejb.SelectField" optionsscript="@quot;月度;年度@quot;;" optionstext="" optionsvalue="" dialogview="" optionseditmode="01" module="" name="_pType" readonlyshowvalonly="true" isdefaultvalue="false" refreshmode="0" refreshfields=""></select></td>
        </tr>
        <tr abp="29922">
            <td class="td_label" abp="29923" width="120">计划级别Plan level</td>
            <td abp="29924"><select id="11e3-44fb-b5748841-bf16-33864f4d4b3c" class="cn.myapps.runtime.dynaform.form.ejb.SelectField" abp="29925" filtercondition="" discript="计划级别" mobile="true" valuescript="//计划级别值脚本@amp;#13;var@nbsp;_pType@nbsp;=@nbsp;getItemValue(@quot;_pType@quot;);@amp;#13;if(_pType!=null@nbsp;@amp;@amp;@nbsp;_pType==(@quot;年度@quot;)){@amp;#13;&#9;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;rtn;@amp;#13;}" hiddenscript="" calculateonrefresh="true" refreshonchanged="true" processdescription="[];[]" editmode="01" validaterule="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)){@amp;#13;&#9;var@nbsp;_pLevel@nbsp;=@nbsp;getItemValue(@quot;_pLevel@quot;);@amp;#13;&#9;if(_pLevel!=null@nbsp;@amp;@amp;@nbsp;_pLevel==(@quot;督办@quot;)){@amp;#13;&#9;&#9;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;&#9;&#9;var@nbsp;roles@nbsp;=@nbsp;webUser.getRoles();@amp;#13;&#9;&#9;var@nbsp;rtn@nbsp;=@nbsp;false;@amp;#13;&#9;&#9;for(var@nbsp;iter@nbsp;=@nbsp;roles.iterator();iter.hasNext();){@amp;#13;&#9;&#9;&#9;var@nbsp;role@nbsp;=@nbsp;iter.next();@amp;#13;&#9;&#9;&#9;var@nbsp;roleNo@nbsp;=@nbsp;role.getRoleNo();@amp;#13;&#9;&#9;&#9;if(roleNo==1007@nbsp;||@nbsp;roleNo==1008@nbsp;||@nbsp;roleNo==1009@nbsp;||@nbsp;roleNo==1010){@amp;#13;&#9;&#9;&#9;&#9;rtn@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;break;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;&#9;if(!rtn){@amp;#13;&#9;&#9;&#9;var@nbsp;rtnStr@nbsp;=@nbsp;@quot;您没有权限新建督办级别的计划！@quot;;@amp;#13;&#9;&#9;&#9;rtnStr;@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="//&ldquo;计划级别&rdquo;只读脚本@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;_pType@nbsp;=@nbsp;getItemValue(@quot;_pType@quot;);@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if((stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草部门主任审核@quot;)@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;))@nbsp;@amp;@amp;@nbsp;_pType!=null@nbsp;@amp;@amp;@nbsp;!_pType==(@quot;年度@quot;)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_VARCHAR" classname="cn.myapps.runtime.dynaform.form.ejb.SelectField" optionsscript="//计划级别选项脚本@amp;#13;var@nbsp;_pType@nbsp;=@nbsp;getItemValue(@quot;_pType@quot;);@amp;#13;var@nbsp;opts@nbsp;=@nbsp;createOptions();//常规、重点、督办@amp;#13;if(_pType!=null@nbsp;@amp;@amp;@nbsp;_pType==(@quot;年度@quot;)){@amp;#13;&#9;opts.add(@#146;@#146;,@#146;@#146;);@amp;#13;&#9;opts.add(@#146;常规@#146;,@#146;常规@#146;);@amp;#13;&#9;opts.add(@#146;重点@#146;,@#146;重点@#146;);@amp;#13;&#9;opts.add(@#146;督办@#146;,@#146;督办@#146;);@amp;#13;}else@nbsp;{@amp;#13;&#9;opts.add(@#146;常规@#146;,@#146;常规@#146;);@amp;#13;&#9;opts.add(@#146;重点@#146;,@#146;重点@#146;);@amp;#13;&#9;opts.add(@#146;督办@#146;,@#146;督办@#146;);@amp;#13;}@amp;#13;opts;" optionstext="" optionsvalue="" dialogview="" optionseditmode="01" module="" name="_pLevel" readonlyshowvalonly="true" isdefaultvalue="false" refreshmode="0" refreshfields=""></select></td>
            <td class="td_label" abp="29926" width="120">专项计划Special Plan</td>
            <td abp="29927"><input id="11e3-44fc-aeb56e77-bf16-33864f4d4b3c" class="cn.myapps.runtime.dynaform.form.ejb.CheckboxField" value="on" name="_pSpecial" abp="29928" filtercondition="" discript="专项计划" mobile="true" valuescript="//专项计划值脚本@amp;#13;var@nbsp;_pType@nbsp;=@nbsp;getItemValue(@quot;_pType@quot;);@amp;#13;if(_pType!=null@nbsp;@amp;@amp;@nbsp;_pType==(@quot;年度@quot;)){@amp;#13;&#9;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;rtn;@amp;#13;}" hiddenscript="" calculateonrefresh="true" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="//&ldquo;专项计划&rdquo;只读脚本@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;_pType@nbsp;=@nbsp;getItemValue(@quot;_pType@quot;);@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if((stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草部门主任审核@quot;)@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;))@nbsp;@amp;@amp;@nbsp;_pType!=null@nbsp;@amp;@amp;@nbsp;!_pType==(@quot;年度@quot;)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.CheckboxField" optionsscript="@quot;是yes@quot;" optionstext="" optionsvalue="" dialogview="" optionseditmode="01" module="" layout="horizontal" type="checkbox" isdefaultvalue="false" refreshmode="0" refreshfields="" /></td>
        </tr>
        <tr abp="29929">
            <td class="td_label" abp="29930"><span class="noEmpty" abp="29931">*</span>计划标题Project title</td>
            <td colspan="3" abp="29932"><input id="11e3-3470-226d0b7a-9257-15373ee2b333" class="cn.myapps.runtime.dynaform.form.ejb.InputField" size="1" value="" name="_pTitle" abp="29933" filtercondition="" discript="计划标题" mobile="true" fieldkeyevent="Tabkey" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="core.dynaform.form.formfield.validate.checkEmpty_system" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#10;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#10;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草部门主任审核@quot;)@amp;#10;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#10;@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#10;@amp;#13;}@amp;#10;@amp;#13;rtn;" numberpattern="" bordertype="false" fieldtype="VALUE_TYPE_VARCHAR" text="text" classname="cn.myapps.runtime.dynaform.form.ejb.InputField" style=" width: 780px" /></td>
        </tr>
        <tr abp="29934">
            <td class="td_label" abp="29935">质量标准Quality Standard</td>
            <td colspan="3" abp="29936"><textarea id="11e3-3af6-8d27d374-8426-7b355eda1d73" class="cn.myapps.runtime.dynaform.form.ejb.TextareaField" rows="1" cols="22" abp="29937" filtercondition="" discript="质量标准" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#10;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#10;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#10;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;职能部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#10;@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#10;@amp;#13;}@amp;#10;@amp;#13;rtn;" bordertype="false" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.TextareaField" style="height: 42px; width: 780px" name="_pStandard"></textarea></td>
        </tr>
        <tr abp="29938">
            <td class="td_label" abp="29939">计划来源Planning Source</td>
            <td colspan="3" abp="29940"><input id="11e3-3470-84f81887-9257-15373ee2b333" class="cn.myapps.runtime.dynaform.form.ejb.InputField" size="32" value="" name="_pSource" abp="29941" filtercondition="" discript="计划来源" mobile="true" fieldkeyevent="Tabkey" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="var@nbsp;_pType@nbsp;=@nbsp;getItemValueAsString(@quot;_pType@quot;);@amp;#10;@amp;#13;var@nbsp;_pSource@nbsp;=@nbsp;getItemValueAsString(@quot;_pSource@quot;);@amp;#10;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#10;@amp;#13;if(_pType!=null@nbsp;@amp;@amp;@nbsp;_pType==(@quot;年度@quot;)@nbsp;@amp;@amp;@nbsp;_pSource!=null@nbsp;@amp;@amp;@nbsp;_pSource==(@quot;@quot;)){@amp;#10;@amp;#13;&#9;rtn@nbsp;=@nbsp;@quot;年度计划必须填写计划来源！@quot;;@amp;#10;@amp;#13;}@amp;#10;@amp;#13;rtn;" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#10;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#10;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草部门主任审核@quot;)@amp;#10;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#10;@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#10;@amp;#13;}@amp;#10;@amp;#13;rtn;" numberpattern="" bordertype="false" fieldtype="VALUE_TYPE_VARCHAR" text="text" classname="cn.myapps.runtime.dynaform.form.ejb.InputField" style=" width: 780px" /></td>
        </tr>
        <tr abp="29942">
            <td class="td_label" abp="29943"><span class="noEmpty" abp="29944">*</span>执行部门Executive Department</td>
            <td abp="29945"><select id="11e3-422d-ed55c725-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.DepartmentField" abp="29946" filtercondition="" discript="执行部门" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="true" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="core.dynaform.form.formfield.validate.checkEmpty_system" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草部门主任审核@quot;)@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_VARCHAR" classname="cn.myapps.runtime.dynaform.form.ejb.DepartmentField" isdefaultvalue="false" allowempty="true" defaultoptiontype="16" relatedfield="" departmentlevel="1" limitbyuser="false" isdepartmentfield="true" type="text" style="width: 153px" name="_pDepartment" readonlyshowvalonly="true" showlog="true" width="185" widthunit="px" hidetype="parent" ishidetype="false" instantvalidate="false" refreshmode="0" refreshfields="" attributeid="undefined"></select></td>
            <td class="td_label" abp="29947"><span class="noEmpty" abp="29948">*</span>完成时间Completion time</td>
            <td abp="29949">
            <p><input id="11e3-44fd-22ab8f40-bf16-33864f4d4b3c" class="cn.myapps.runtime.dynaform.form.ejb.DateField" value="" name="_pEndTime" abp="29950" filtercondition="" discript="完成时间" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="(function(){@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)){@amp;#13;&#9;var@nbsp;_pEndTime@nbsp;=@nbsp;getItemValueAsDate(@quot;_pEndTime@quot;);@amp;#13;&#9;if(_pEndTime==null@nbsp;||@nbsp;_pEndTime==(@quot;@quot;)){@amp;#13;&#9;&#9;rtn@nbsp;=@nbsp;@quot;完成时间不能为空!@quot;;@amp;#13;&#9;}else{@amp;#13;&#9;&#9;var@nbsp;curDate@nbsp;=@nbsp;getCurDate(@quot;yyyy-MM-dd@nbsp;HH:mm:ss@quot;);@amp;#13;&#9;&#9;_pEndTime@nbsp;=@nbsp;format(_pEndTime,@quot;yyyy-MM-dd@nbsp;HH:mm:ss@quot;);&#9;//date--@gt;string@amp;#13;&#9;&#9;var@nbsp;days@nbsp;=@nbsp;diffDays(curDate,@nbsp;_pEndTime);&#9;//string--@gt;int@amp;#13;&#9;&#9;if(days@lt;7){@amp;#13;&#9;&#9;&#9;rtn@nbsp;=@nbsp;@quot;完成时间不能在7个工作天内！@quot;;@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;return@nbsp;rtn;@amp;#13;})();" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_DATE" classname="cn.myapps.runtime.dynaform.form.ejb.DateField" datepattern="YMD_HM" prev_name="" limit="false" isdefaultvalue="false" type="text" readonlyshowvalonly="true" refreshmode="0" refreshfields="" /><span abp="29951" style="color: green">过了完成时间再提延期申请将多</span><span abp="29951" style="color: green">考核1次！</span></p>
            <p><span abp="29951" style="color: green">only personnel in the executive department can be selected!</span></p>
            </td>
        </tr>
        <tr abp="29952">
            <td class="td_label" abp="29953">负责单位(班组)Responsible unit (team)</td>
            <td abp="29954">
            <p><select id="11e3-422e-fb1d0adf-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.DepartmentField" abp="29955" filtercondition="" discript="负责单位(班组)" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="true" refreshonchanged="true" processdescription="[];[]" editmode="01" validaterule="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划分配@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草部门主任审核@quot;)@amp;#13;&#9;&#9;@nbsp;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#13;&#9;var@nbsp;_p2Department@nbsp;=@nbsp;getItemValueAsString(@quot;_p2Department@quot;);@amp;#13;&#9;var@nbsp;_pResponsible@nbsp;=@nbsp;getItemValueAsString(@quot;_pResponsible@quot;);@amp;#13;&#9;if(_p2Department!=null@nbsp;@amp;@amp;@nbsp;_p2Department@nbsp;!=(@quot;@quot;)@nbsp;@amp;@amp;@nbsp;_pResponsible!=null@nbsp;@amp;@amp;@nbsp;_pResponsible@nbsp;!=(@quot;@quot;)){@amp;#13;&#9;&#9;rtn@nbsp;=@nbsp;@quot;@#146;负责单位(班组)@#146;和@#146;负责人@#146;只能填一个！@quot;;@amp;#13;&#9;}@amp;#13;}@amp;#13;rtn;" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="/**&ldquo;负责单位(班组)&rdquo;、&ldquo;负责人&rdquo;、&ldquo;配合单位(班组)&rdquo;、&ldquo;配合人&rdquo;只读脚本**/@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;isExecuteDirector@nbsp;=@nbsp;false;&#9;&#9;//是否执行部门主任或副主任@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValueAsString(@quot;_pDepartment@quot;);@amp;#13;//当前登录用户是否执行部门主任@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;println(@quot;isNotNull(roleName)====@gt;@quot;+isNotNull(roleName));@amp;#13;if(isNotNull(roleName)@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;if(isNotNull(role)){@nbsp;@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;break;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;@amp;#13;@amp;#13;//当前登录用户是否执行部门副主任@amp;#13;if(!isExecuteDirector@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1003@quot;,getApplication());&#9;//1003是部门副主任编号@amp;#13;&#9;if(isNotNull(roleName)){@amp;#13;&#9;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;//当前登录用户是否执行部门计划分配员@amp;#13;if(!isExecuteDirector@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1012@quot;,getApplication());&#9;//1012是计划分配员编号@amp;#13;&#9;if(isNotNull(roleName)){@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划分配@quot;)@amp;#13;&#9;&#9;||@nbsp;(stateLabel==(@quot;计划执行@quot;)@nbsp;@amp;@amp;@nbsp;isExecuteDirector)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_VARCHAR" classname="cn.myapps.runtime.dynaform.form.ejb.DepartmentField" isdefaultvalue="false" allowempty="true" defaultoptiontype="16" relatedfield="_pDepartment" departmentlevel="2" limitbyuser="false" isdepartmentfield="true" type="text" style="width: 153px" name="_p2Department" readonlyshowvalonly="true" showlog="true" width="185" widthunit="px" hidetype="parent" ishidetype="false" instantvalidate="false" refreshmode="0" refreshfields="" attributeid="undefined"></select><span abp="29956" style="color: green">负责单位和负责人只能填一个！</span></p>
            <p><span abp="29956" style="color: green">only secondary units (teams) under the executive department can be selected!<img id="11e3-ebe5-0c21d9dd-967d-3785f474b24b" src="plugins/calctextfield/calctextfield.gif" valuescript="/**@amp;#13;@nbsp;*@nbsp;负责单位(班组)后的计算脚本@amp;#13;@nbsp;**/@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;if(stateLabel!=null@nbsp;@amp;@amp;@nbsp;stateLabel==(@quot;计划执行@quot;)){@amp;#13;&#9;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;var@nbsp;usersId@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;var@nbsp;_p2Department@nbsp;=@nbsp;getItemValueAsString(@quot;_p2Department@quot;);@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptId(_p2Department);@amp;#13;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;for(var@nbsp;iter@nbsp;=@nbsp;users.iterator();iter.hasNext();){@amp;#13;&#9;&#9;&#9;var@nbsp;user@nbsp;=@nbsp;iter.next();@amp;#13;&#9;&#9;&#9;if(usersId==(@quot;@quot;)){@amp;#13;&#9;&#9;&#9;&#9;usersId@nbsp;+=@nbsp;user.getId();@amp;#13;&#9;&#9;&#9;}else@nbsp;{@amp;#13;&#9;&#9;&#9;&#9;usersId@nbsp;+=@nbsp;@quot;,@quot;@nbsp;+@nbsp;user.getId();@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;&#9;rtn@nbsp;+=@nbsp;@quot;@lt;input@nbsp;type=@#146;hidden@#146;@nbsp;name=@#146;_p2DepartmentUsers@#146;@nbsp;value=@#146;@quot;@nbsp;+@nbsp;usersId@nbsp;+@quot;@#146;@nbsp;pValue=@#146;@quot;@nbsp;+@nbsp;_p2Department@nbsp;+@nbsp;@quot;@#146;/@gt;@quot;;@amp;#13;&#9;rtn;@amp;#13;}" calculateonrefresh="true" classname="cn.myapps.runtime.dynaform.form.ejb.CalctextField" name="QZf7aeb3828" /></span></p>
            </td>
            <td class="td_label" abp="29957">负责人Person in charge</td>
            <td abp="29958"><select id="11e3-589a-057bbd8e-95bd-5ff35db4b26f" class="cn.myapps.runtime.dynaform.form.ejb.SelectField" abp="29959" filtercondition="" discript="负责人" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="true" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="var@nbsp;_pDepartment@nbsp;=@nbsp;getItemValue(@quot;_pDepartment@quot;);@amp;#13;if(isNotNull(_pDepartment)){@amp;#13;&#9;println(@quot;_pDepartment===@gt;@quot;+_pDepartment);@amp;#13;&#9;var@nbsp;process@nbsp;=@nbsp;createProcess(@quot;cn.myapps.core.authtime.department.service.DepartmentProcess@quot;);//部门业务处理类@amp;#13;&#9;var@nbsp;dept=process.doView(_pDepartment);//id为部门ID，获取部门对象@amp;#13;&#9;if(dept!=null){@amp;#13;&#9;&#9;var@nbsp;name=dept.getName();@amp;#13;&#9;&#9;if(name!=null@nbsp;@amp;@amp;@nbsp;(name==(@quot;厂领导@quot;)@nbsp;||@nbsp;name==(@quot;副总师@quot;))){@amp;#13;&#9;&#9;&#9;var@nbsp;_pResponsible@nbsp;=@nbsp;getItemValue(@quot;_pResponsible@quot;);@amp;#13;&#9;&#9;&#9;if(_pResponsible!=null@nbsp;@amp;@amp;@nbsp;_pResponsible==(@quot;@quot;)){@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;rtn@nbsp;=@nbsp;@quot;@#146;执行部门@#146;是@#146;@quot;+name+@quot;@#146;时@#146;负责人@#146;不能为空！@quot;;@amp;#13;&#9;&#9;&#9;&#9;rtn;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="/**&ldquo;负责单位(班组)&rdquo;、&ldquo;负责人&rdquo;、&ldquo;配合单位(班组)&rdquo;、&ldquo;配合人&rdquo;只读脚本**/@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;isExecuteDirector@nbsp;=@nbsp;false;&#9;&#9;//是否执行部门主任或副主任@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValueAsString(@quot;_pDepartment@quot;);@amp;#13;//当前登录用户是否执行部门主任@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;println(@quot;isNotNull(roleName)====@gt;@quot;+isNotNull(roleName));@amp;#13;if(isNotNull(roleName)){@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;if(isNotNull(role)@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@nbsp;@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;break;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;@amp;#13;@amp;#13;//当前登录用户是否执行部门副主任@amp;#13;if(!isExecuteDirector@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1003@quot;,getApplication());&#9;//1003是部门副主任编号@amp;#13;&#9;if(isNotNull(roleName)){@amp;#13;&#9;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;//当前登录用户是否执行部门计划分配员@amp;#13;if(!isExecuteDirector@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1012@quot;,getApplication());&#9;//1012是计划分配员编号@amp;#13;&#9;if(isNotNull(roleName)){@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划分配@quot;)@amp;#13;&#9;&#9;||@nbsp;(stateLabel==(@quot;计划执行@quot;)@nbsp;@amp;@amp;@nbsp;isExecuteDirector)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_VARCHAR" classname="cn.myapps.runtime.dynaform.form.ejb.SelectField" optionsscript="//负责人选项脚本@amp;#13;var@nbsp;_pDepartment@nbsp;=@nbsp;getItemValue(@quot;_pDepartment@quot;);@amp;#13;var@nbsp;opts@nbsp;=@nbsp;createOptions();@amp;#13;opts.add(@quot;@quot;,@quot;@quot;);@amp;#13;if(isNotNull(_pDepartment)@nbsp;@amp;@amp;@nbsp;_pDepartment!=(@quot;@quot;)){@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptId(_pDepartment);@amp;#13;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;user=iter1.next();@amp;#13;&#9;@nbsp;@nbsp;@nbsp;@nbsp;opts.add(user.getName(),user.getId());@amp;#13;&#9;}@amp;#13;&#9;//下级部门@amp;#13;&#9;/**@amp;#13;&#9;var@nbsp;process@nbsp;=@nbsp;createProcess(@quot;cn.myapps.core.authtime.department.service.DepartmentProcess@quot;);@amp;#13;&#9;var@nbsp;depVos@nbsp;=@nbsp;process.getDatasByParent(_pDepartment);@amp;#13;&#9;if(depVos!=null@nbsp;@amp;@amp;@nbsp;depVos.size()@gt;0){@amp;#13;&#9;&#9;for(var@nbsp;iter1=depVos.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;dept=iter1.next();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;depId1=@nbsp;dept.getId();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;users@nbsp;=@nbsp;getUsersByDptId(depId1);@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;for(var@nbsp;iter2=users.iterator();iter2.hasNext();){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;user=iter2.next();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;opts.add(user.getName(),user.getId());@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;&#9;**/@amp;#13;}@amp;#13;opts;" optionstext="" optionsvalue="" dialogview="" optionseditmode="01" module="" isdefaultvalue="false" style="width: 155px" name="_pResponsible" layout="horizontal" readonlyshowvalonly="true" showlog="true" hidetype="parent" ishidetype="false" instantvalidate="false" multiselect="false" clearable="false" multipledisplaymode="full" width="" widthunit="px" refreshmode="0" refreshfields="" attributeid="undefined"></select><img id="11e3-ebe5-17395bee-967d-3785f474b24b" src="plugins/calctextfield/calctextfield.gif" valuescript="/**@amp;#13;@nbsp;*@nbsp;负责人后的计算脚本@amp;#13;@nbsp;**/@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;btn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;if(stateLabel!=null@nbsp;@amp;@amp;@nbsp;stateLabel==(@quot;计划执行@quot;)){@amp;#13;&#9;var@nbsp;isExecuteDirector@nbsp;=@nbsp;false;&#9;&#9;//是否执行部门主任或副主任@amp;#13;&#9;var@nbsp;_pConstantAuditor@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;&#9;var@nbsp;webUserId@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;if(webUser!=null){@amp;#13;&#9;&#9;webUserId@nbsp;=@nbsp;webUser.getId();@amp;#13;&#9;}@amp;#13;&#9;var@nbsp;depId@nbsp;=@nbsp;getItemValueAsString(@quot;_pDepartment@quot;);@amp;#13;&#9;//当前登录用户是否执行部门主任@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;if(user!=null){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;var@nbsp;userId@nbsp;=@nbsp;user.getId();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;if(_pConstantAuditor==(@quot;@quot;)){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;&#9;_pConstantAuditor@nbsp;+=@nbsp;userId;@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;}else@nbsp;{@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;&#9;_pConstantAuditor@nbsp;+=@nbsp;@quot;,@quot;@nbsp;+@nbsp;userId;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;if(webUserId==(userId)){@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;&#9;//1、当前登录用户是否执行部门副主任；2、增加部门副主任@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1003@quot;,getApplication());&#9;//1003是部门副主任编号@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;if(user!=null){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;var@nbsp;userId@nbsp;=@nbsp;user.getId();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;if(_pConstantAuditor==(@quot;@quot;)){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;&#9;_pConstantAuditor@nbsp;+=@nbsp;userId;@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;}else@nbsp;{@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;&#9;_pConstantAuditor@nbsp;+=@nbsp;@quot;,@quot;@nbsp;+@nbsp;userId;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;if(webUserId==(userId)){@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;&#9;@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1012@quot;,getApplication());&#9;//1012是计划分配员编号@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;if(user!=null){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;var@nbsp;userId@nbsp;=@nbsp;user.getId();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;if(_pConstantAuditor==(@quot;@quot;)){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;&#9;_pConstantAuditor@nbsp;+=@nbsp;userId;@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;}else@nbsp;{@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;&#9;_pConstantAuditor@nbsp;+=@nbsp;@quot;,@quot;@nbsp;+@nbsp;userId;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;if(webUserId==(userId)){@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;&#9;if(isExecuteDirector){@amp;#13;&#9;&#9;var@nbsp;usersId@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;&#9;var@nbsp;_p2Department@nbsp;=@nbsp;getItemValueAsString(@quot;_p2Department@quot;);@amp;#13;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptId(_p2Department);@amp;#13;&#9;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;&#9;for(var@nbsp;iter@nbsp;=@nbsp;users.iterator();iter.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;user@nbsp;=@nbsp;iter.next();@amp;#13;&#9;&#9;&#9;&#9;if(usersId==(@quot;@quot;)){@amp;#13;&#9;&#9;&#9;&#9;&#9;usersId@nbsp;+=@nbsp;user.getId();@amp;#13;&#9;&#9;&#9;&#9;}else@nbsp;{@amp;#13;&#9;&#9;&#9;&#9;&#9;usersId@nbsp;+=@nbsp;@quot;,@quot;@nbsp;+@nbsp;user.getId();@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;&#9;var@nbsp;_pResponsible@nbsp;=@nbsp;getItemValueAsString(@quot;_pResponsible@quot;);@amp;#13;&#9;&#9;if(_pResponsible!=null@nbsp;@amp;@amp;@nbsp;_pResponsible !=(@quot;@quot;)){@amp;#13;&#9;&#9;&#9;if(usersId==(@quot;@quot;)){@amp;#13;&#9;&#9;&#9;&#9;usersId@nbsp;+=@nbsp;_pResponsible;@amp;#13;&#9;&#9;&#9;}else@nbsp;{@amp;#13;&#9;&#9;&#9;&#9;usersId@nbsp;+=@nbsp;@quot;,@quot;@nbsp;+@nbsp;_pResponsible;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;&#9;btn@nbsp;=@nbsp;@quot;@lt;input@nbsp;type=@#146;button@#146;@nbsp;onclick=@#146;editAuditorByFieldVal()@#146;@nbsp;value=@#146;计划分配@#146;@nbsp;style=@#146;font-size:@nbsp;14px;font-weight:@nbsp;bold;height:@nbsp;30px;width:@nbsp;80px;color:@nbsp;#0356FC;@#146;@nbsp;title=@#146;修改负责单位(人)和配合单位(人)后点击@#146;/@gt;@lt;span@nbsp;style=@#146;color:green;@#146;@gt;修改负责单位(人)和配合单位(人)后点击!@lt;/span@gt;@quot;;@amp;#13;&#9;&#9;btn@nbsp;+=@nbsp;@quot;@lt;input@nbsp;type=@#146;hidden@#146;@nbsp;name=@#146;_p2DepartmentDefault@#146;@nbsp;value=@#146;@quot;@nbsp;+@nbsp;usersId@nbsp;+@nbsp;@quot;@#146;@nbsp;/@gt;@quot;;&#9;//设置负责班组的默认用户，修改负责班组时先删除默认用户再添加新用户@amp;#13;&#9;&#9;btn@nbsp;+=@nbsp;@quot;@lt;input@nbsp;type=@#146;hidden@#146;@nbsp;name=@#146;_pConstantAuditor@#146;@nbsp;value=@#146;@quot;@nbsp;+@nbsp;_pConstantAuditor@nbsp;+@nbsp;@quot;@#146;/@gt;@quot;;&#9;//设置执行部门主任、副主任、计划分配员，在指定为负责人后再改为其他人员时，避免被删除@amp;#13;&#9;}@amp;#13;}@amp;#13;btn;" calculateonrefresh="false" classname="cn.myapps.runtime.dynaform.form.ejb.CalctextField" name="QZb994df83a" /></td>
        </tr>
        <tr abp="29960">
            <td class="td_label" abp="29961">配合单位(班组)Cooperating units (teams)</td>
            <td abp="29962">
            <p><span abp="29963" style="color: green"><select id="11e3-5897-fadfe5e5-95bd-5ff35db4b26f" abp="29964" discript="配合单位(班组)" mobile="true" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.TreeDepartmentField" type="text" limit="15" texttype="text" calculateonrefresh="false" validatelibs="" validaterule="/**@amp;#13;@nbsp;*@nbsp;配合单位(班组)检验脚本（检验了配合人）@amp;#13;@nbsp;**/@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;if(stateLabel@nbsp;==@nbsp;null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草部门主任审核@quot;)@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划执行@quot;)){@amp;#13;&#9;var@nbsp;_pDepartment@nbsp;=@nbsp;getItemValueAsString(@quot;_pDepartment@quot;);@amp;#13;&#9;var@nbsp;_pCooperateDept@nbsp;=@nbsp;getItemValueAsString(@quot;_pCooperateDept@quot;);@amp;#13;&#9;var@nbsp;_pCooperatePerson@nbsp;=@nbsp;getItemValueAsString(@quot;_pCooperatePerson@quot;);@amp;#13;&#9;var@nbsp;_pCooperateDepts@nbsp;=@nbsp;_pCooperateDept.split(@quot;;@quot;);@amp;#13;&#9;var@nbsp;_pCooperatePersons@nbsp;=@nbsp;_pCooperatePerson.split(@quot;;@quot;);@amp;#13;&#9;var@nbsp;process@nbsp;=@nbsp;createProcess(@quot;cn.myapps.core.authtime.department.service.DepartmentProcess@quot;);//部门业务处理类@amp;#13;&#9;var@nbsp;_pDepartmentObj;@amp;#13;&#9;if(isNotNull(_pDepartment)){@amp;#13;&#9;&#9;_pDepartmentObj@nbsp;=@nbsp;process.doView(_pDepartment);@amp;#13;&#9;}@amp;#13;&#9;@amp;#13;&#9;var@nbsp;_pDepartmentName@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;if(_pDepartmentObj!=null){@amp;#13;&#9;&#9;_pDepartmentName@nbsp;=@nbsp;_pDepartmentObj.getName();@amp;#13;&#9;}@amp;#13;@amp;#13;&#9;@amp;#13;&#9;var@nbsp;deptNames@nbsp;=@nbsp;@quot;@quot;;@amp;#13;@amp;#13;&#9;if(isNotNull(_pCooperateDept)@nbsp;){@amp;#13;&#9;&#9;println(@quot;进入@quot;);@amp;#13;&#9;&#9;for@nbsp;(@nbsp;var@nbsp;i@nbsp;=@nbsp;0;@nbsp;i@nbsp;@lt;@nbsp;_pCooperateDepts.length;@nbsp;i++)@nbsp;{@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;_pCooperateDeptId@nbsp;=@nbsp;_pCooperateDepts[i];@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;dept=process.doView(_pCooperateDeptId);//id为部门ID，获取部门对象@amp;#13;&#9;&#9;&#9;&#9;if(dept!=null){@amp;#13;&#9;&#9;&#9;&#9;&#9;var@nbsp;deptSuper=dept.getSuperior();@amp;#13;&#9;&#9;&#9;&#9;&#9;if(deptSuper!=null){@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;var@nbsp;deptSuperId@nbsp;=@nbsp;deptSuper.getId();@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;if(deptSuperId!=null@nbsp;@amp;@amp;@nbsp;deptSuperId!=(_pDepartment)){@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;&#9;deptNames@nbsp;+=@nbsp;@quot;@#146;@quot;+dept.getName()+@quot;@#146;,@quot;;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;}@amp;#13;&#9;@amp;#13;&#9;println(@quot;_pCooperatePersons==2=@gt;@quot;+_pCooperatePersons);@amp;#13;&#9;var@nbsp;userNames@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;for(var@nbsp;i=0;i@lt;_pCooperatePersons.length;i++){@amp;#13;&#9;&#9;println(@quot;_pCooperatePersons==3=@gt;@quot;+_pCooperatePersons);@amp;#13;&#9;&#9;var@nbsp;_pCooperatePerson@nbsp;=@nbsp;_pCooperatePersons[i];@amp;#13;&#9;&#9;var@nbsp;userVo@nbsp;=@nbsp;getUserById(_pCooperatePerson);@amp;#13;&#9;&#9;if(userVo!=null){@amp;#13;&#9;&#9;&#9;var@nbsp;depts@nbsp;=@nbsp;userVo.getDepartments();@amp;#13;&#9;&#9;&#9;var@nbsp;isAdd@nbsp;=@nbsp;false;@amp;#13;&#9;&#9;&#9;for(var@nbsp;iter@nbsp;=@nbsp;depts.iterator();@nbsp;iter.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;dept@nbsp;=@nbsp;iter.next();@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;depproc=getDepartmentProcess();@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;odeps@nbsp;=@nbsp;depproc.getSuperiorDeptListExcludeCurrent(dept.getId());@amp;#13;&#9;&#9;&#9;&#9;if(odeps!=null@nbsp;@amp;@amp;@nbsp;odeps.size()@gt;0){@amp;#13;&#9;&#9;&#9;&#9;&#9;for@nbsp;(var@nbsp;it@nbsp;=odeps.iterator();@nbsp;it.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;var@nbsp;department@nbsp;=@nbsp;it.next();@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;var@nbsp;deptId@nbsp;=@nbsp;department.getId();@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;if(deptId!=null@nbsp;@amp;@amp;@nbsp;deptId==(_pDepartment)){@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;&#9;isAdd@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;&#9;break;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;if(isAdd){@amp;#13;&#9;&#9;&#9;&#9;&#9;break;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;if(!isAdd){@amp;#13;&#9;&#9;&#9;&#9;userNames@nbsp;+=@nbsp;@quot;@#146;@quot;@nbsp;+@nbsp;userVo.getName()@nbsp;+@nbsp;@quot;@#146;,@quot;;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;&#9;if(!deptNames==(@quot;@quot;)){@amp;#13;&#9;&#9;rtn@nbsp;+=@nbsp;deptNames+@quot;不是@#146;@quot;@nbsp;+@nbsp;_pDepartmentName+@quot;@#146;的下级部门，配合单位(班组)只能选择执行部门的下级部门;@quot;;@amp;#13;&#9;}@amp;#13;&#9;if(!userNames==(@quot;@quot;)){@amp;#13;&#9;&#9;rtn@nbsp;+=@nbsp;userNames+@quot;不是@#146;@quot;@nbsp;+@nbsp;_pDepartmentName+@quot;@#146;的员工，配合人只能选择执行部门中的人员;@quot;;@amp;#13;&#9;}@amp;#13;}@amp;#13;rtn;" hiddenscript="" hiddenvalue="" hiddenprintscript="" printhiddenvalue="" readonlyscript="/**&ldquo;负责单位(班组)&rdquo;、&ldquo;负责人&rdquo;、&ldquo;配合单位(班组)&rdquo;、&ldquo;配合人&rdquo;只读脚本**/@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;isExecuteDirector@nbsp;=@nbsp;false;&#9;&#9;//是否执行部门主任或副主任@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValueAsString(@quot;_pDepartment@quot;);@amp;#13;//当前登录用户是否执行部门主任@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;println(@quot;isNotNull(roleName)====@gt;@quot;+isNotNull(roleName));@amp;#13;if(isNotNull(roleName)){@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;if(isNotNull(role)@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@nbsp;@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;break;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;@amp;#13;@amp;#13;//当前登录用户是否执行部门副主任@amp;#13;if(!isExecuteDirector@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1003@quot;,getApplication());&#9;//1003是部门副主任编号@amp;#13;&#9;if(isNotNull(roleName)){@amp;#13;&#9;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;//当前登录用户是否执行部门计划分配员@amp;#13;if(!isExecuteDirector@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1012@quot;,getApplication());&#9;//1012是计划分配员编号@amp;#13;&#9;if(isNotNull(roleName)){@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划分配@quot;)@amp;#13;&#9;&#9;||@nbsp;(stateLabel==(@quot;计划执行@quot;)@nbsp;@amp;@amp;@nbsp;isExecuteDirector)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" editmode="01" isdefaultvalue="false" istreedepartmentfield="true" refreshonchanged="true" class="cn.myapps.runtime.dynaform.form.ejb.TreeDepartmentField" style="width: 153px" name="_pCooperateDept" readonlyshowvalonly="true" showlog="true" valuescript="" width="185" layout="horizontal" hidetype="parent" ishidetype="false" processdescription="[];[]" instantvalidate="false" refreshmode="0" refreshfields="" attributeid="undefined"></select>只能选择执行部门下的二级单位(班组)！</span></p>
            <p><span abp="29963" style="color: green">only secondary units (teams) under the executive department can be selected!</span> <img id="11e3-ec71-9a4ec547-9a8f-5f16a2502d19" class="cn.myapps.runtime.dynaform.form.ejb.CalctextField" src="plugins/calctextfield/calctextfield.gif" classname="cn.myapps.runtime.dynaform.form.ejb.CalctextField" calculateonrefresh="true" valuescript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#10;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#10;@amp;#13;if(stateLabel@nbsp;!=@nbsp;null@nbsp;@amp;@amp;@nbsp;stateLabel==(@quot;计划执行@quot;)){@amp;#10;@amp;#13;&#9;var@nbsp;_pDepartment@nbsp;=@nbsp;getItemValueAsString(@quot;_pDepartment@quot;);@amp;#10;@amp;#13;&#9;var@nbsp;_pCooperateDept@nbsp;=@nbsp;getItemValueAsString(@quot;_pCooperateDept@quot;);@amp;#10;@amp;#13;&#9;var@nbsp;_pCooperatePerson@nbsp;=@nbsp;getItemValueAsString(@quot;_pCooperatePerson@quot;);@amp;#10;@amp;#13;&#9;var@nbsp;_pCooperateDepts@nbsp;=@nbsp;_pCooperateDept.split(@quot;;@quot;);@amp;#10;@amp;#13;&#9;var@nbsp;_pCooperatePersons@nbsp;=@nbsp;_pCooperatePerson.split(@quot;;@quot;);@amp;#10;@amp;#13;&#9;var@nbsp;process@nbsp;=@nbsp;createProcess(@quot;cn.myapps.core.authtime.department.service.DepartmentProcess@quot;);//部门业务处理类@amp;#10;@amp;#13;&#9;var@nbsp;_pDepartmentObj@nbsp;=@nbsp;process.doView(_pDepartment);@amp;#10;@amp;#13;&#9;var@nbsp;_pDepartmentName@nbsp;=@nbsp;@quot;@quot;;@amp;#10;@amp;#13;&#9;if(_pDepartmentObj!=null){@amp;#10;@amp;#13;&#9;&#9;_pDepartmentName@nbsp;=@nbsp;_pDepartmentObj.getName();@amp;#10;@amp;#13;&#9;}@amp;#10;@amp;#13;&#9;var@nbsp;deptNames@nbsp;=@nbsp;@quot;@quot;;@amp;#10;@amp;#13;&#9;for@nbsp;(@nbsp;var@nbsp;i@nbsp;=@nbsp;0;@nbsp;i@nbsp;@lt;@nbsp;_pCooperateDepts.length;@nbsp;i++)@nbsp;{@amp;#10;@amp;#13;&#9;&#9;var@nbsp;_pCooperateDeptId@nbsp;=@nbsp;_pCooperateDepts[i];@amp;#10;@amp;#13;&#9;&#9;var@nbsp;dept=process.doView(_pCooperateDeptId);//id为部门ID，获取部门对象@amp;#10;@amp;#13;&#9;&#9;if(dept!=null){@amp;#10;@amp;#13;&#9;&#9;&#9;var@nbsp;deptSuper=dept.getSuperior();@amp;#10;@amp;#13;&#9;&#9;&#9;if(deptSuper!=null){@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;deptSuperId@nbsp;=@nbsp;deptSuper.getId();@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;if(deptSuperId!=null@nbsp;@amp;@amp;@nbsp;deptSuperId!=(_pDepartment)){@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;deptNames@nbsp;+=@nbsp;@quot;@#146;@quot;+dept.getName()+@quot;@#146;,@quot;;@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#10;@amp;#13;&#9;&#9;&#9;}@amp;#10;@amp;#13;&#9;&#9;}@amp;#10;@amp;#13;&#9;}@amp;#10;@amp;#13;&#9;var@nbsp;userNames@nbsp;=@nbsp;@quot;@quot;;@amp;#10;@amp;#13;&#9;for(var@nbsp;i=0;i@lt;_pCooperatePersons.length;i++){@amp;#10;@amp;#13;&#9;&#9;var@nbsp;_pCooperatePerson@nbsp;=@nbsp;_pCooperatePersons[i];@amp;#10;@amp;#13;&#9;&#9;var@nbsp;userVo@nbsp;=@nbsp;getUserById(_pCooperatePerson);@amp;#10;@amp;#13;&#9;&#9;if(userVo!=null){@amp;#10;@amp;#13;&#9;&#9;&#9;var@nbsp;depts@nbsp;=@nbsp;userVo.getDepartments();@amp;#10;@amp;#13;&#9;&#9;&#9;var@nbsp;isAdd@nbsp;=@nbsp;false;@amp;#10;@amp;#13;&#9;&#9;&#9;for(var@nbsp;iter@nbsp;=@nbsp;depts.iterator();@nbsp;iter.hasNext();){@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;dept@nbsp;=@nbsp;iter.next();@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;depproc=getDepartmentProcess();@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;odeps@nbsp;=@nbsp;depproc.getSuperiorDeptListExcludeCurrent(dept.getId());@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;if(odeps!=null@nbsp;@amp;@amp;@nbsp;odeps.size()@gt;0){@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;for@nbsp;(var@nbsp;it@nbsp;=odeps.iterator();@nbsp;it.hasNext();){@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;var@nbsp;department@nbsp;=@nbsp;it.next();@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;var@nbsp;deptId@nbsp;=@nbsp;department.getId();@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;if(deptId!=null@nbsp;@amp;@amp;@nbsp;deptId==(_pDepartment)){@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;&#9;isAdd@nbsp;=@nbsp;true;@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;&#9;break;@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;}@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;}@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;if(isAdd){@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;&#9;break;@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#10;@amp;#13;&#9;&#9;&#9;}@amp;#10;@amp;#13;&#9;&#9;&#9;if(!isAdd){@amp;#10;@amp;#13;&#9;&#9;&#9;&#9;userNames@nbsp;+=@nbsp;@quot;@#146;@quot;@nbsp;+@nbsp;userVo.getName()@nbsp;+@nbsp;@quot;@#146;,@quot;;@amp;#10;@amp;#13;&#9;&#9;&#9;}@amp;#10;@amp;#13;&#9;&#9;}@amp;#10;@amp;#13;&#9;}@amp;#10;@amp;#13;&#9;rtn@nbsp;+=@nbsp;@quot;@lt;input@nbsp;type=@quot;hidden@quot;@nbsp;name=@quot;_pCooperateRemind@quot;@nbsp;value=@quot;@quot;;@amp;#10;@amp;#13;&#9;if(!deptNames==(@quot;@quot;)){@amp;#10;@amp;#13;&#9;&#9;rtn@nbsp;+=@nbsp;deptNames+@quot;不是@#146;@quot;@nbsp;+@nbsp;_pDepartmentName+@quot;@#146;的下级部门，配合单位(班组)只能选择执行部门的下级部门;@quot;;@amp;#10;@amp;#13;&#9;}@amp;#10;@amp;#13;&#9;if(!userNames==(@quot;@quot;)){@amp;#10;@amp;#13;&#9;&#9;rtn@nbsp;+=@nbsp;userNames+@quot;不是@#146;@quot;@nbsp;+@nbsp;_pDepartmentName+@quot;@#146;的员工，配合人只能选择执行部门中的人员;@quot;;@amp;#10;@amp;#13;&#9;}@amp;#10;@amp;#13;&#9;rtn@nbsp;+=@nbsp;@quot;@quot;@nbsp;/@gt;@quot;;@amp;#10;@amp;#13;}@amp;#10;@amp;#13;rtn;@amp;#10;@amp;#13;" name="QZ5a69ae802" /></p>
            </td>
            <td class="td_label" abp="29965">配合人Cooperator</td>
            <td abp="29966">
            <p><select id="11e3-5898-09cc8b22-95bd-5ff35db4b26f" class="cn.myapps.runtime.dynaform.form.ejb.UserField" abp="29967" filtercondition="" discript="配合人" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="true" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="/**&ldquo;负责单位(班组)&rdquo;、&ldquo;负责人&rdquo;、&ldquo;配合单位(班组)&rdquo;、&ldquo;配合人&rdquo;只读脚本**/@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;isExecuteDirector@nbsp;=@nbsp;false;&#9;&#9;//是否执行部门主任或副主任@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValueAsString(@quot;_pDepartment@quot;);@amp;#13;//当前登录用户是否执行部门主任@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;println(@quot;isNotNull(roleName)====@gt;@quot;+isNotNull(roleName));@amp;#13;if(isNotNull(roleName)@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;if(isNotNull(role)@amp;@amp;@nbsp;isNotNull(depId)){@nbsp;@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;break;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;@amp;#13;@amp;#13;//当前登录用户是否执行部门副主任@amp;#13;if(!isExecuteDirector@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1003@quot;,getApplication());&#9;//1003是部门副主任编号@amp;#13;&#9;if(isNotNull(roleName)@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;//当前登录用户是否执行部门计划分配员@amp;#13;if(!isExecuteDirector@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1012@quot;,getApplication());&#9;//1012是计划分配员编号@amp;#13;&#9;if(isNotNull(roleName)){@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;&#9;if(users!=null@nbsp;@amp;@amp;@nbsp;users.size()@gt;0){@amp;#13;&#9;&#9;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;&#9;&#9;isExecuteDirector@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;&#9;}@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划分配@quot;)@amp;#13;&#9;&#9;||@nbsp;(stateLabel==(@quot;计划执行@quot;)@nbsp;@amp;@amp;@nbsp;isExecuteDirector)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.UserField" isdefaultvalue="false" limitbyuser="false" type="text" filterfield="" limitsum="10" selectmode="multiSelect" isuserfield="true" style="width: 155px" name="_pCooperatePerson" readonlyshowvalonly="true" showlog="true" layout="horizontal" width="" widthunit="px" hidetype="parent" ishidetype="false" instantvalidate="false" refreshmode="0" refreshfields="" attributeid="undefined"></select><span abp="29968" style="color: green">只能选择执行部门内人员！</span></p>
            <p><span abp="29968" style="color: green">only personnel in the executive department can be selected!</span></p>
            </td>
        </tr>
        <tr name="_reason_hide" abp="29969">
            <td class="td_label" abp="29970">汇报时间Reporting time</td>
            <td abp="29971"><input id="11e3-4232-7f5c255d-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.DateField" value="" name="_pReportTime" abp="29972" filtercondition="" discript="汇报时间" mobile="true" valuescript="" hiddenscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;false;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;职能部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划执行@quot;)){@amp;#13;&#9;//rtn@nbsp;=@nbsp;true;@amp;#13;}@amp;#13;rtn;" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="readonly" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" fieldtype="VALUE_TYPE_DATE" classname="cn.myapps.runtime.dynaform.form.ejb.DateField" datepattern="YMD" prev_name="" limit="false" type="text" readonlyshowvalonly="false" isdefaultvalue="false" refreshmode="0" refreshfields="" width="" widthunit="px" showlog="true" hidetype="parent" ishidetype="false" instantvalidate="false" attributeid="undefined" /></td>
            <td class="td_label" abp="29973">汇报次数Number of Reports</td>
            <td abp="29974"><input id="11e3-4b49-0388f646-9e60-2fb8180195a0" class="cn.myapps.runtime.dynaform.form.ejb.InputField" value="" name="_pReportCount" abp="29975" filtercondition="" discript="汇报次数" mobile="true" fieldkeyevent="Tabkey" valuescript="" hiddenscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;false;@amp;#13;if(stateLabel@nbsp;==@nbsp;null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;职能部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划执行@quot;)){@amp;#13;&#9;//rtn@nbsp;=@nbsp;true;@amp;#13;}@amp;#13;rtn;" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="readonly" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" numberpattern="##" bordertype="false" fieldtype="VALUE_TYPE_NUMBER" text="readonly" classname="cn.myapps.runtime.dynaform.form.ejb.InputField" readonlyshowvalonly="true" isdefaultvalue="false" refreshmode="0" refreshfields="" /></td>
        </tr>
        <tr abp="29976">
            <td class="td_label" abp="29977"><span class="noEmpty" abp="29978">*</span>验收部门Acceptance Department</td>
            <td abp="29979">
            <p><span class="remind" abp="29980"><select id="11e3-4235-71b369d0-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.DepartmentField" abp="29981" filtercondition="" discript="验收部门" mobile="true" valuescript="//验收部门值脚本@amp;#13;var@nbsp;_pLevel@nbsp;=@nbsp;getItemValue(@quot;_pLevel@quot;);@amp;#13;var@nbsp;_pCheckDepartment@nbsp;=@nbsp;getItemValue(@quot;_pCheckDepartment@quot;);@amp;#13;if(_pCheckDepartment!=null@nbsp;@amp;@amp;@nbsp;_pCheckDepartment==(@quot;@quot;)@nbsp;@amp;@amp;@nbsp;_pLevel!=null@nbsp;@amp;@amp;@nbsp;_pLevel==(@quot;督办@quot;)){@amp;#13;&#9;var@nbsp;depProcess@nbsp;=@nbsp;getDepartmentProcess();@amp;#13;&#9;var@nbsp;depts@nbsp;=@nbsp;depProcess.getDepartmentByCode(@#146;003@#146;,getDomainid());@amp;#13;&#9;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;&#9;for@nbsp;(var@nbsp;it@nbsp;=@nbsp;depts.iterator();@nbsp;it.hasNext();)@nbsp;{@amp;#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;department@nbsp;=@nbsp;it.next();@amp;#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;rtn@nbsp;=@nbsp;department.getId();@amp;#13;&#9;}@amp;#13;&#9;rtn;@amp;#13;}" hiddenscript="" calculateonrefresh="true" refreshonchanged="true" processdescription="[];[]" editmode="01" validaterule="//验收部门检验脚本@amp;#13;var@nbsp;_pLevel@nbsp;=@nbsp;getItemValueAsString(@quot;_pLevel@quot;);@amp;#13;var@nbsp;_pDepartment@nbsp;=@nbsp;getItemValueAsString(@quot;_pDepartment@quot;);@amp;#13;var@nbsp;_pCheckDepartment@nbsp;=@nbsp;getItemValueAsString(@quot;_pCheckDepartment@quot;);@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;@quot;@quot;;@amp;#13;if(_pCheckDepartment!=null@nbsp;@amp;@amp;@nbsp;_pCheckDepartment==(@quot;@quot;)){@amp;#13;&#9;rtn@nbsp;+=@nbsp;@quot;@#146;验收部门@#146;不能为空！@quot;;@amp;#13;}@amp;#13;if(_pLevel!=null@nbsp;@amp;@amp;@nbsp;!_pLevel==(@quot;常规@quot;)@nbsp;@amp;@amp;@nbsp;isNotNull(_pDepartment)@nbsp;@amp;@amp;@nbsp;_pCheckDepartment!=null@nbsp;@amp;@amp;@nbsp;_pDepartment==(_pCheckDepartment)){@amp;#13;&#9;rtn@nbsp;+=@nbsp;@quot;@#146;验收部门@#146;不能和@#146;执行部门@#146;相同！@quot;;@amp;#13;}@amp;#13;rtn;" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;职能部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_VARCHAR" classname="cn.myapps.runtime.dynaform.form.ejb.DepartmentField" isdefaultvalue="false" allowempty="true" defaultoptiontype="16" relatedfield="" departmentlevel="1" limitbyuser="false" isdepartmentfield="true" type="text" style="width: 153px" name="_pCheckDepartment" readonlyshowvalonly="true" showlog="true" width="185" widthunit="px" hidetype="parent" ishidetype="false" instantvalidate="false" refreshmode="0" refreshfields="" attributeid="undefined"></select>非常规计划时不能和执行部门相同！</span></p>
            <p><span class="remind" abp="29980">it can't be the same as the implementation department in case of unconventional plan!&nbsp;</span></p>
            </td>
            <td class="td_label" abp="29982">验收人Acceptor</td>
            <td abp="29983"><select id="11e3-589a-4beedd0f-95bd-5ff35db4b26f" class="cn.myapps.runtime.dynaform.form.ejb.SelectField" abp="29984" filtercondition="" discript="验收人" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="true" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="var@nbsp;_pDepartment@nbsp;=@nbsp;getItemValue(@quot;_pCheckDepartment@quot;);@amp;#13;if(isNotNull(_pDepartment)){@amp;#13;&#9;var@nbsp;process@nbsp;=@nbsp;createProcess(@quot;cn.myapps.core.authtime.department.service.DepartmentProcess@quot;);//部门业务处理类@amp;#13;&#9;var@nbsp;dept=process.doView(_pDepartment);//id为部门ID，获取部门对象@amp;#13;&#9;if(dept!=null){@amp;#13;&#9;&#9;var@nbsp;name=dept.getName();@amp;#13;&#9;&#9;if(name!=null@nbsp;@amp;@amp;@nbsp;(name==(@quot;厂领导@quot;)@nbsp;||@nbsp;name==(@quot;副总师@quot;))){@amp;#13;&#9;&#9;&#9;var@nbsp;_pChecker@nbsp;=@nbsp;getItemValue(@quot;_pChecker@quot;);@amp;#13;&#9;&#9;&#9;if(_pChecker!=null@nbsp;@amp;@amp;@nbsp;_pChecker==(@quot;@quot;)){@amp;#13;&#9;&#9;&#9;&#9;var@nbsp;rtn@nbsp;=@nbsp;@quot;@#146;验收部门@#146;是@#146;@quot;+name+@quot;@#146;时@#146;验收人@#146;不能为空！@quot;;@amp;#13;&#9;&#9;&#9;&#9;rtn;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="//&ldquo;指定验收人&rdquo;节点只有当前用户是验收部门主任或副主任时才为false@amp;#13;var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValue(@quot;_pCheckDepartment@quot;);@amp;#13;//是否验收部门主任判断@amp;#13;var@nbsp;role1004@nbsp;=@nbsp;false;&#9;&#9;//当前登录用户是否验收部门主任@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;if(isNotNull(roleName)@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;role1004@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;@amp;#13;@amp;#13;var@nbsp;role1003@nbsp;=@nbsp;false;&#9;&#9;//当前登录用户是否验收部门副主任@amp;#13;if(!role1004@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;//是否验收部门副主任判断@amp;#13;&#9;var@nbsp;roleName=getRoleByRoleNo(@quot;1003@quot;,getApplication());&#9;//1003是部门副主任编号@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;if(isNotNull(roleName)){@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;role1003@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if((stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;验收部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;))@nbsp;||@nbsp;(stateLabel@nbsp;==@nbsp;@quot;计划执行@quot;@nbsp;@amp;@amp;@nbsp;(role1004@nbsp;||@nbsp;role1003))){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_VARCHAR" classname="cn.myapps.runtime.dynaform.form.ejb.SelectField" optionsscript="var@nbsp;_pDepartment@nbsp;=@nbsp;getItemValue(@quot;_pCheckDepartment@quot;);@amp;#13;var@nbsp;opts@nbsp;=@nbsp;createOptions();@amp;#13;opts.add(@quot;@quot;,@quot;@quot;);@amp;#13;if(isNotNull(_pDepartment)@nbsp;@amp;@amp;@nbsp;_pDepartment!=(@quot;@quot;)){@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptId(_pDepartment);@amp;#13;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;user=iter1.next();@amp;#13;&#9;@nbsp;@nbsp;@nbsp;@nbsp;opts.add(user.getName(),user.getId());@amp;#13;&#9;}@amp;#13;&#9;//下级部门@amp;#13;&#9;var@nbsp;process@nbsp;=@nbsp;createProcess(@quot;cn.myapps.core.authtime.department.service.DepartmentProcess@quot;);@amp;#13;&#9;var@nbsp;depVos@nbsp;=@nbsp;process.getDatasByParent(_pDepartment);@amp;#13;&#9;if(depVos!=null@nbsp;@amp;@amp;@nbsp;depVos.size()@gt;0){@amp;#13;&#9;&#9;for(var@nbsp;iter1=depVos.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;dept=iter1.next();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;depId1=@nbsp;dept.getId();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;users@nbsp;=@nbsp;getUsersByDptId(depId1);@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;for(var@nbsp;iter2=users.iterator();iter2.hasNext();){@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;user=iter2.next();@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;opts.add(user.getName(),user.getId());@amp;#13;&#9;&#9;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;opts;" optionstext="" optionsvalue="" dialogview="" optionseditmode="01" module="" style="width: 155px" name="_pChecker" isdefaultvalue="false" layout="horizontal" readonlyshowvalonly="true" showlog="true" hidetype="parent" ishidetype="false" instantvalidate="false" multiselect="false" clearable="false" multipledisplaymode="full" width="" widthunit="px" refreshmode="0" refreshfields="" attributeid="undefined"></select></td>
        </tr>
        <tr abp="29985" style="display: none">
            <td class="td_label" abp="29986">最后考核时间</td>
            <td abp="29987"><input id="11e3-4236-87103424-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.DateField" value="" name="_pLastCheckTime" abp="29988" filtercondition="" discript="最后考核时间" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" fieldtype="VALUE_TYPE_DATE" classname="cn.myapps.runtime.dynaform.form.ejb.DateField" datepattern="YMD" prev_name="" limit="false" /><img id="11e3-423a-bbbd7982-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.CalctextField" src="http://localhost:8080/obpm/core/dynaform/form/webeditor/editor/plugins/calctextfield/calctextfield.gif" abp="29989" valuescript="#include@nbsp;@quot;表单函数@quot;;@amp;#10;@amp;#13;thisStateLabel();" calculateonrefresh="false" classname="cn.myapps.runtime.dynaform.form.ejb.CalctextField" name="QZ782592920" /></td>
            <td class="td_label" abp="29990">已延期</td>
            <td abp="29991"><input id="11e3-4687-b20a1040-8183-e7f4dcdf2bee" class="cn.myapps.runtime.dynaform.form.ejb.CheckboxField" value="on" name="_isDefer" abp="29992" filtercondition="" discript="已延期" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.CheckboxField" optionsscript="@quot;是@quot;" optionstext="" optionsvalue="" dialogview="" optionseditmode="01" module="" layout="horizontal" type="checkbox" /></td>
        </tr>
        <tr abp="29993" style="display: none">
            <td class="td_label" abp="29994">厂领导审批人</td>
            <td abp="29995"><select id="11e3-5244-b9a09757-8a15-dbec6c028713" class="cn.myapps.runtime.dynaform.form.ejb.UserField" abp="29996" filtercondition="" discript="厂领导审批人" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.UserField" limitbyuser="false" type="text" filterfield="" limitsum="10" selectmode="selectOne" isuserfield="isUserField" name="_pFactoryLeader"></select></td>
            <td class="td_label" abp="29997">已取消</td>
            <td abp="29998"><input id="11e3-4687-c0118697-8183-e7f4dcdf2bee" class="cn.myapps.runtime.dynaform.form.ejb.CheckboxField" value="on" name="_isCancel" abp="29999" filtercondition="" discript="已取消" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.CheckboxField" optionsscript="@quot;是@quot;" optionstext="" optionsvalue="" dialogview="" optionseditmode="01" module="" layout="horizontal" type="checkbox" /></td>
        </tr>
        <tr abp="30000" style="display: none">
            <td class="td_label" abp="30001">申请延期的时间</td>
            <td abp="30002"><input id="11e3-c534-e5360276-821e-0b7b9f7433e4" class="cn.myapps.runtime.dynaform.form.ejb.DateField" value="" name="_pApplyDeferTime" abp="30003" filtercondition="" discript="申请延期的时间" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" fieldtype="VALUE_TYPE_DATE" classname="cn.myapps.runtime.dynaform.form.ejb.DateField" datepattern="YMD" prev_name="" limit="false" /></td>
            <td class="td_label" abp="30004">&nbsp;</td>
            <td abp="30005">&nbsp;</td>
        </tr>
        <tr name="_reason_hide" abp="30006">
            <td class="td_label" abp="30007">延期时间Extension time</td>
            <td abp="30008">
            <p><input id="11e3-57e9-e64dc634-b377-abf0fdc101d3" class="cn.myapps.runtime.dynaform.form.ejb.DateField" value="" name="_pDeferTime" abp="30009" filtercondition="" discript="延期时间" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="text" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;var@nbsp;isRight@nbsp;=@nbsp;false;&#9;&#9;//当前登录用户是否验收部门主任@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValue(@quot;_pCheckDepartment@quot;);@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;if(isNotNull(roleName)@nbsp;@amp;@amp;@nbsp;isNotNull(depId)){@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;if(isNotNull(role)){@amp;#13;&#9;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;&#9;isRight@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;&#9;}@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel!=null@nbsp;@amp;@amp;@nbsp;((stateLabel==(@quot;计划执行@quot;)@nbsp;@amp;@amp;@nbsp;!isRight)@nbsp;||@nbsp;stateLabel==(@quot;执行部门主任延期审核@quot;)@amp;#13;&#9;&#9;@nbsp;||@nbsp;stateLabel==(@quot;验收人延期审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;验收部门主任延期审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导延期审批@quot;))){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" fieldtype="VALUE_TYPE_DATE" classname="cn.myapps.runtime.dynaform.form.ejb.DateField" datepattern="YMD" prev_name="_pEndTime" limit="true" type="text" width="" widthunit="px" readonlyshowvalonly="true" showlog="true" isdefaultvalue="false" hidetype="parent" ishidetype="false" instantvalidate="false" refreshmode="0" refreshfields="" attributeid="undefined" /><span abp="30010" style="color: green">成功申请1次以上延期将考核！</span></p>
            <p><span abp="30010" style="color: green">Extension time (successful application for more than one extension will be assessed!</span></p>
            </td>
            <td class="td_label" abp="30011">延期次数Delays</td>
            <td abp="30012"><input id="11e3-6180-3ef553d5-a9b8-1df6844d9f48" class="cn.myapps.runtime.dynaform.form.ejb.InputField" value="" name="_pDeferCount" abp="30013" filtercondition="" discript="延期次数" mobile="true" fieldkeyevent="Tabkey" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" texttype="readonly" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="" numberpattern="##" bordertype="false" fieldtype="VALUE_TYPE_NUMBER" text="readonly" classname="cn.myapps.runtime.dynaform.form.ejb.InputField" hidetype="parent" ishidetype="false" layout="horizontal" readonlyshowvalonly="true" showlog="true" arrow="false" width="" widthunit="px" worklimitchecked="false" textareamaxlimit="" isdefaultvalue="false" secrettext="false" defaultvalueisnull="false" instantvalidate="false" refreshmode="0" refreshfields="" attributeid="undefined" /></td>
        </tr>
        <tr name="_reason_hide" abp="30014">
            <td class="td_label" abp="30015"><span abp="30016">延期理由Reason for Extension/Delay</span></td>
            <td colspan="3" abp="30017"><textarea id="11e3-4237-546cfc94-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.TextareaField" cols="25" abp="30018" filtercondition="" discript="延期理由" mobile="true" valuescript="" hiddenscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#10;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;false;@amp;#10;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#10;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;职能部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#10;@amp;#13;&#9;rtn@nbsp;=@nbsp;true;@amp;#10;@amp;#13;}@amp;#10;@amp;#13;rtn;" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#10;@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#10;@amp;#13;var@nbsp;isRight@nbsp;=@nbsp;false;&#9;&#9;//当前登录用户是否验收部门主任@amp;#10;@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValue(@quot;_pCheckDepartment@quot;);@amp;#10;@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#10;@amp;#13;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#10;@amp;#13;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#10;@amp;#13;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#10;@amp;#13;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#10;@amp;#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;user=iter1.next();@amp;#10;@amp;#13;@nbsp;@nbsp;@nbsp;@nbsp;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#10;@amp;#13;@nbsp;@nbsp;@nbsp;@nbsp;&#9;isRight@nbsp;=@nbsp;true;@amp;#10;@amp;#13;@nbsp;@nbsp;@nbsp;@nbsp;}@amp;#10;@amp;#13;}@amp;#10;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#10;@amp;#13;if(stateLabel!=null@nbsp;@amp;@amp;@nbsp;((stateLabel==(@quot;计划执行@quot;)@nbsp;@amp;@amp;@nbsp;!isRight)@nbsp;||@nbsp;stateLabel==(@quot;执行部门主任延期审核@quot;))){@amp;#10;@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#10;@amp;#13;}@amp;#10;@amp;#13;rtn;" bordertype="false" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.TextareaField" style="height: 36px; width: 780px" name="_pDeferReason"></textarea></td>
        </tr>
        <tr name="_reason_hide" abp="30019">
            <td class="td_label" abp="30020"><span abp="30021">取消理由Reason for cancellation</span></td>
            <td colspan="3" abp="30022"><textarea id="11e3-4237-685a272a-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.TextareaField" cols="13" abp="30023" filtercondition="" discript="取消理由" mobile="true" valuescript="" hiddenscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;false;@amp;#13;if(stateLabel==null@nbsp;||@nbsp;stateLabel==(@quot;@quot;)@nbsp;||@nbsp;stateLabel==(@quot;计划起草@quot;)@nbsp;||@nbsp;stateLabel==(@quot;起草计划部门主任审核@quot;)@nbsp;@amp;#13;&#9;&#9;||@nbsp;stateLabel==(@quot;职能部门主任审核@quot;)@nbsp;||@nbsp;stateLabel==(@quot;厂领导审批@quot;)){@amp;#13;&#9;rtn@nbsp;=@nbsp;true;@amp;#13;}@amp;#13;rtn;" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="var@nbsp;stateLabel@nbsp;=@nbsp;getStateLabel();@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;var@nbsp;isRight@nbsp;=@nbsp;false;&#9;&#9;//当前登录用户是否验收部门主任@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValue(@quot;_pCheckDepartment@quot;);@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;if(isNotNull(roleName)){@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;isRight@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;true;@amp;#13;if(stateLabel!=null@nbsp;@amp;@amp;@nbsp;((stateLabel==(@quot;计划执行@quot;)@nbsp;@amp;@amp;@nbsp;!isRight)@nbsp;||@nbsp;stateLabel==(@quot;执行部门主任取消审核@quot;))){@amp;#13;&#9;rtn@nbsp;=@nbsp;false;@amp;#13;}@amp;#13;rtn;" bordertype="false" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.TextareaField" style="height: 36px; width: 780px" name="_pCancelReason" texttype="text" readonlyshowvalonly="true" showlog="true" hidetype="parent" ishidetype="false" worklimitchecked="false" isdefaultvalue="false" instantvalidate="false" width="" widthunit="px" refreshmode="0" refreshfields="" textareaheight="" textareamaxlimit="" attributeid="undefined"></textarea></td>
        </tr>
        <tr>
            <td>完成情况Completion situation</td>
            <td colspan="2"><textarea classname="cn.myapps.runtime.dynaform.form.ejb.TextareaField" id="11ed-d37b-321f8d4e-9697-c7566c83f3b2" name="完成情况" readonlyshowvalonly="true" fieldtype="VALUE_TYPE_TEXT" discript="" validaterule="" valuescript="" hiddenscript="" hiddenvalue="" hiddenprintscript="" printhiddenvalue="" readonlyscript="" filtercondition="" refreshonchanged="false" isdefaultvalue="false" calculateonrefresh="false" mobile="true" validatelibs="" editmode="01" processdescription="[];[]" refreshmode="0" refreshfields="" style="margin: 2px; width: 778px; height: 42px;" texttype="text" showlog="true" hidetype="parent" ishidetype="false" worklimitchecked="false" instantvalidate="false" width="" widthunit="px" textareaheight="" textareamaxlimit="" attributeid="undefined"></textarea></td>
            <td>上传附件upload attachment<img src="plugins/attachmentuploadfield/attachment.gif" classname="cn.myapps.runtime.dynaform.form.ejb.AttachmentUploadField" id="11ed-d37b-446f0d4f-9697-c7566c83f3b2" type="attachmentupload" fieldtype="VALUE_TYPE_TEXT" openwatermark="false" watermarksupportmode="" watermarkscript="" name="附件" validaterule="" validatelibs="" limitsize="" limitnumber="10" refreshonchanged="false" calculateonrefresh="false" readonlyshowvalonly="true" mobile="true" previewedit="true" supportsorting="false" discript="" hiddenscript="" hiddenvalue="" hiddenprintscript="" printhiddenvalue="" readonlyscript="" filepattern="00" filecatalog="" filetype="00" refreshmode="0" refreshfields="" customizetype="" /></td>
        </tr>
        <tr abp="30024">
            <td class="td_label" abp="30025">计划备注&nbsp;Plan Remarks</td>
            <td colspan="3" abp="30026"><textarea id="11e3-4237-76c0ad50-89f4-ffe2ceff1059" class="cn.myapps.runtime.dynaform.form.ejb.TextareaField" cols="24" abp="30027" filtercondition="" discript="计划备注" mobile="true" valuescript="" hiddenscript="" calculateonrefresh="false" refreshonchanged="false" processdescription="[];[]" editmode="01" validaterule="" validatelibs="" hiddenprintscript="" hiddenvalue="" printhiddenvalue="" readonlyscript="//流程状态为&ldquo;计划执行&rdquo;，当前登录用户是验收部门主任时@amp;#13;var@nbsp;webUser@nbsp;=@nbsp;getWebUser();@amp;#13;var@nbsp;isRight@nbsp;=@nbsp;false;&#9;&#9;//当前登录用户是否验收部门主任@amp;#13;var@nbsp;depId@nbsp;=@nbsp;getItemValue(@quot;_pCheckDepartment@quot;);@amp;#13;var@nbsp;roleName=getRoleByRoleNo(@quot;1004@quot;,getApplication());&#9;//1004是部门主任编号@amp;#13;if(isNotNull(roleName)){@amp;#13;&#9;var@nbsp;role@nbsp;=@nbsp;findRoleByName(roleName);@amp;#13;&#9;var@nbsp;roleId@nbsp;=@nbsp;role.getId();@amp;#13;&#9;var@nbsp;users@nbsp;=@nbsp;getUsersByDptIdAndRoleId(depId,roleId);@amp;#13;&#9;for(var@nbsp;iter1=users.iterator();iter1.hasNext();){@amp;#13;&#9;&#9;var@nbsp;user=iter1.next();@amp;#13;&#9;&#9;if(user!=null@nbsp;@amp;@amp;@nbsp;webUser!=null@nbsp;@amp;@amp;@nbsp;webUser.getId()==(user.getId())){@amp;#13;&#9;&#9;&#9;isRight@nbsp;=@nbsp;true;@amp;#13;&#9;&#9;}@amp;#13;&#9;}@amp;#13;}@amp;#13;@amp;#13;var@nbsp;rtn@nbsp;=@nbsp;false;@amp;#13;if(isRight@nbsp;@amp;@amp;@nbsp;stateLabel!=null@nbsp;@amp;@amp;@nbsp;stateLabel==(@quot;计划执行@quot;)){@amp;#13;&#9;rtn@nbsp;=@nbsp;true;@amp;#13;}@amp;#13;rtn;" bordertype="false" fieldtype="VALUE_TYPE_TEXT" classname="cn.myapps.runtime.dynaform.form.ejb.TextareaField" style="height: 36px; width: 780px" name="_pRemark" texttype="text" readonlyshowvalonly="true" showlog="true" hidetype="parent" ishidetype="false" worklimitchecked="false" isdefaultvalue="false" instantvalidate="false" width="" widthunit="px" refreshmode="0" refreshfields="" textareaheight="" textareamaxlimit="" attributeid="undefined"></textarea></td>
        </tr>
    </tbody>
</table>
</p>
<p abp="30028">&nbsp;</p>
<p abp="30036"><script>
function hideEle(objName){
	jQuery("[name="+objName+"]").css("display","none");
}

jQuery(document).ready(function(){
	var stateLabel = jQuery("#stateLabel").val();
	if(stateLabel == "null" || stateLabel == "" || stateLabel == "计划起草" || stateLabel == "计划起草部门主任审核"
		|| stateLabel == "验收部门主任审核" || stateLabel == "厂领导审批"){//汇报时间、延期理由、取消理由
		hideEle("_reason_hide");
	}
});
</script></p>]]></templatecontext>
  <type>1</type>
  <styleId>11e9-7a26-62f43cbf-9820-539e9af1e136</styleId>
  <showLog>true</showLog>
  <showLogType>default</showLogType>
  <openComment>false</openComment>
  <commentTitleScript><![CDATA[]]></commentTitleScript>
  <commentFlagScript><![CDATA[]]></commentFlagScript>
  <commentHiddenScrtipt><![CDATA[]]></commentHiddenScrtipt>
  <commentExecuteScript><![CDATA[]]></commentExecuteScript>
  <recordMode>every</recordMode>
  <recordModeScript><![CDATA[]]></recordModeScript>
  <showType>old</showType>
  <showWaterMark>false</showWaterMark>
  <waterMarkScript></waterMarkScript>
  <version>1</version>
  <isopenablescript><![CDATA[]]></isopenablescript>
  <iseditablescript><![CDATA[]]></iseditablescript>
  <mappingStr><![CDATA[{"formName":"plant_plan","tableName":"","columnMappings":[]}]]></mappingStr>
  <orderno>0</orderno>
  <permissionType>public</permissionType>
  <layoutType>horizontal</layoutType>
</form>